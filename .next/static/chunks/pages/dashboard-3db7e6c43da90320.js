(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(4910)}])},4910:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(5893),n=s(7294),r=s(1163),l=s(1663),i=s(2810);function c(e){let{title:t,value:s,icon:n,color:r="primary"}=e;return(0,a.jsxs)("div",{className:"bg-white rounded shadow border p-3 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-1 rounded ".concat({primary:"bg-primary-100 text-primary-700",success:"bg-green-100 text-green-700",danger:"bg-red-100 text-red-700"}[r]),children:n}),(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500 font-medium",children:t}),(0,a.jsxs)("span",{className:"text-base font-semibold text-gray-900",children:["$",s.toLocaleString()]})]})]})}var o=s(1834),d=s(6495),x=s(3148);function m(e){let{data:t}=e;return(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(d.by,{data:t,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,font:{size:12}}},tooltip:{callbacks:{label:function(e){let t=e.label||"",s=e.raw||0;return"".concat(t,": $").concat(s.toLocaleString())}}}}}})})}function u(e){let{data:t}=e;return(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(d.$Q,{data:t,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){let t=e.raw||0;return"$".concat(t.toLocaleString())}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return"$"+e.toLocaleString()}}}}}})})}x.kL.register(x.qi,x.u,x.De),x.kL.register(x.uw,x.f$,x.ZL,x.Dx,x.u,x.De);var h=s(1410),p=s(81),b=s(4698),g=s(4516),f=s(8283),j=s(5692);function y(){let{user:e,loading:t}=(0,h.a)(),s=(0,r.useRouter)(),[d,x]=(0,n.useState)([]),[y,N]=(0,n.useState)([]),[v,w]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(!t&&!e){s.push("/login");return}e&&k()},[e,t,s]);let k=async()=>{try{let[e,t]=await Promise.all([l.Z.get("/api/income"),l.Z.get("/api/expense")]);x(e.data),N(t.data)}catch(e){console.error("Error fetching data:",e)}finally{w(!1)}},_=async(e,t)=>{try{await l.Z.delete("/api/".concat(t,"/").concat(e)),k()}catch(e){console.error("Error deleting transaction:",e)}};if(t||v)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});let D=d.reduce((e,t)=>e+t.amount,0),E=y.reduce((e,t)=>e+t.amount,0),Z=D-E,C=[...d.map(e=>({...e,type:"income"})),...y.map(e=>({...e,type:"expense"}))].sort((e,t)=>new Date(t.date)-new Date(e.date)).slice(0,5),L=new Date;L.setDate(L.getDate()-30);let S=y.filter(e=>new Date(e.date)>=L).reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),A={labels:Object.keys(S),datasets:[{label:"Amount",data:Object.values(S),backgroundColor:"#ef4444",borderColor:"#dc2626",borderWidth:1}]};return(0,a.jsx)(i.Z,{children:(0,a.jsxs)("div",{className:"container mx-auto px-2 py-4 max-w-6xl",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"Dashboard"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Welcome back, ",null==e?void 0:e.name]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>s.push("/income"),className:"flex items-center px-3 py-1.5 text-xs font-medium text-primary-700 bg-primary-100 rounded hover:bg-primary-200 transition",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Add Income"]}),(0,a.jsxs)("button",{onClick:()=>s.push("/expenses"),className:"flex items-center px-3 py-1.5 text-xs font-medium text-red-700 bg-red-100 rounded hover:bg-red-200 transition",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-1"}),"Add Expense"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mb-4",children:[(0,a.jsx)(c,{title:"Total Balance",value:Z,icon:(0,a.jsx)(g.Z,{className:"h-4 w-4"})}),(0,a.jsx)(c,{title:"Total Income",value:D,icon:(0,a.jsx)(f.Z,{className:"h-4 w-4"})}),(0,a.jsx)(c,{title:"Total Expenses",value:E,icon:(0,a.jsx)(j.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded shadow border p-3 flex flex-col",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Financial Overview"}),(0,a.jsx)("div",{className:"h-48",children:(0,a.jsx)(m,{data:{labels:["Balance","Expenses"],datasets:[{data:[Z>0?Z:0,E],backgroundColor:["#22c55e","#ef4444"],borderWidth:0}]}})})]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow border p-3 flex flex-col",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Expense Categories (30 Days)"}),(0,a.jsx)("div",{className:"h-48",children:(0,a.jsx)(u,{data:A})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow border",children:[(0,a.jsx)("div",{className:"p-3 border-b",children:(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-700",children:"Recent Transactions"})}),(0,a.jsx)("div",{children:0===C.length?(0,a.jsx)("div",{className:"p-3 text-xs text-gray-400",children:"No recent transactions."}):C.map(e=>(0,a.jsx)(o.Z,{transaction:e,type:e.type,onDelete:()=>_(e._id,e.type)},"".concat(e.type,"-").concat(e._id)))})]})]})})}}},function(e){e.O(0,[196,660,234,270,888,774,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);