(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(4910)}])},4910:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return w}});var t=s(5893),r=s(7294),n=s(1163),l=s(1663),i=s(2810);function c(e){let{title:a,value:s,icon:r,color:n="primary"}=e;return(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-md border border-gray-100 max-w-sm w-full mx-auto",children:(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 rounded-md ".concat({primary:"bg-primary-50 text-primary-600",success:"bg-success-50 text-success-600",danger:"bg-danger-50 text-danger-600"}[n]),children:r}),(0,t.jsx)("h3",{className:"text-base font-medium text-gray-500",children:a})]}),(0,t.jsxs)("p",{className:"text-xl font-semibold text-gray-900",children:["$",s.toLocaleString()]})]})})})}var d=s(1834),o=s(6495),m=s(3148);function x(e){let{data:a}=e;return(0,t.jsx)("div",{className:"w-full h-full",children:(0,t.jsx)(o.by,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,font:{size:12}}},tooltip:{callbacks:{label:function(e){let a=e.label||"",s=e.raw||0;return"".concat(a,": $").concat(s.toLocaleString())}}}}}})})}function u(e){let{data:a}=e;return(0,t.jsx)("div",{className:"w-full h-full",children:(0,t.jsx)(o.$Q,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){let a=e.raw||0;return"$".concat(a.toLocaleString())}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return"$"+e.toLocaleString()}}}}}})})}m.kL.register(m.qi,m.u,m.De),m.kL.register(m.uw,m.f$,m.ZL,m.Dx,m.u,m.De);var h=s(1410),g=s(81),p=s(4698),b=s(4516),f=s(8283),j=s(5692);function w(){let{user:e,loading:a}=(0,h.a)(),s=(0,n.useRouter)(),[o,m]=(0,r.useState)([]),[w,y]=(0,r.useState)([]),[N,v]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(!a&&!e){s.push("/login");return}e&&k()},[e,a,s]);let k=async()=>{try{let[e,a]=await Promise.all([l.Z.get("/api/income"),l.Z.get("/api/expense")]);m(e.data),y(a.data)}catch(e){console.error("Error fetching data:",e)}finally{v(!1)}},_=async(e,a)=>{try{await l.Z.delete("/api/".concat(a,"/").concat(e)),k()}catch(e){console.error("Error deleting transaction:",e)}};if(a||N)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});let D=o.reduce((e,a)=>e+a.amount,0),E=w.reduce((e,a)=>e+a.amount,0),Z=D-E,C=[...o.map(e=>({...e,type:"income"})),...w.map(e=>({...e,type:"expense"}))].sort((e,a)=>new Date(a.date)-new Date(e.date)).slice(0,5),L=new Date;L.setDate(L.getDate()-30);let S=w.filter(e=>new Date(e.date)>=L).reduce((e,a)=>(e[a.category]=(e[a.category]||0)+a.amount,e),{}),A={labels:Object.keys(S),datasets:[{label:"Amount",data:Object.values(S),backgroundColor:"#ef4444",borderColor:"#dc2626",borderWidth:1}]};return(0,t.jsx)(i.Z,{children:(0,t.jsxs)("div",{className:"container mx-auto p-4 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Welcome back, ",null==e?void 0:e.name]})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("button",{onClick:()=>s.push("/income"),className:"inline-flex items-center px-4 py-2 text-base font-medium text-primary-600 bg-primary-50 rounded-md hover:bg-primary-100 transition-colors",children:[(0,t.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"Add Income"]}),(0,t.jsxs)("button",{onClick:()=>s.push("/expenses"),className:"inline-flex items-center px-4 py-2 text-base font-medium text-danger-600 bg-danger-50 rounded-md hover:bg-danger-100 transition-colors",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5 mr-2"}),"Add Expense"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[(0,t.jsx)("div",{className:"max-w-sm w-full mx-auto",children:(0,t.jsx)(c,{title:"Total Balance",value:Z,icon:(0,t.jsx)(b.Z,{className:"h-5 w-5"})})}),(0,t.jsx)("div",{className:"max-w-sm w-full mx-auto",children:(0,t.jsx)(c,{title:"Total Income",value:D,icon:(0,t.jsx)(f.Z,{className:"h-5 w-5"})})}),(0,t.jsx)("div",{className:"max-w-sm w-full mx-auto",children:(0,t.jsx)(c,{title:"Total Expenses",value:E,icon:(0,t.jsx)(j.Z,{className:"h-5 w-5"})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-md shadow-sm border border-gray-100 p-4 max-w-2xl mx-auto",children:[(0,t.jsx)("h2",{className:"text-base font-medium text-gray-900 mb-4",children:"Financial Overview"}),(0,t.jsx)("div",{className:"h-64",children:(0,t.jsx)(x,{data:{labels:["Balance","Expenses"],datasets:[{data:[Z>0?Z:0,E],backgroundColor:["#22c55e","#ef4444"],borderWidth:0}]}})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-md shadow-sm border border-gray-100 p-4 max-w-2xl mx-auto",children:[(0,t.jsx)("h2",{className:"text-base font-medium text-gray-900 mb-4",children:"Expense Categories (30 Days)"}),(0,t.jsx)("div",{className:"h-64",children:(0,t.jsx)(u,{data:A})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-md shadow-sm border border-gray-100 max-w-3xl mx-auto",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,t.jsx)("h2",{className:"text-base font-medium text-gray-900",children:"Recent Transactions"})}),(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:C.map(e=>(0,t.jsx)(d.Z,{transaction:e,type:e.type,onDelete:()=>_(e._id,e.type)},"".concat(e.type,"-").concat(e._id)))})]})]})})}}},function(e){e.O(0,[196,660,234,270,888,774,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);